# -*- coding: utf-8 -*-
"""Encoder.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-gAYu4ShZuAqf5_Gvr3Ke-anHO1q7AHE

**เข้ารหัส คำใบ้สุดท้าย**


---


- key -> 01000010001000000000000001000010
- plaintext1 -> "wsvr"
- plaintext2-> "Correct"
- Ciphertext1 -> qLJmyJvRIzmRNZMF9NZEodqHRbA2Ywp1WQPDhCCtKso=
- Ciphertext2 -> ngCgwwswcjcivTrAf5bvOQ==
"""

from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import base64

# Key (16 bytes)
key = b'01000010001000000000000001000010'  # ตัวอย่าง Key (16 bytes)

# Plaintext
plaintext1 = "Correct".encode('utf-8')
plaintext2 = "wsvr".encode('utf-8')

# สร้าง Ciphertext โดยใช้ AES.MODE_ECB (ไม่ต้องใช้ IV)
cipher1 = AES.new(key, AES.MODE_ECB)
ciphertext1 = cipher.encrypt(pad(plaintext1, AES.block_size))

cipher2 = AES.new(key, AES.MODE_ECB)
ciphertext2 = cipher.encrypt(pad(plaintext2, AES.block_size))

# แปลง Ciphertext เป็น Base64 เพื่อเก็บและถ่ายโอน
ciphertext_base641 = base64.b64encode(ciphertext1).decode('utf-8')
ciphertext_base642 = base64.b64encode(ciphertext2).decode('utf-8')

# แสดงผล
print("Key (as bytes):", key)
print("Ciphertext (Correct):", ciphertext_base641)
print("Ciphertext (wsvr):", ciphertext_base642)

# บันทึก Ciphertext
encrypted_data1 = ciphertext_base641
encrypted_data2 = ciphertext_base642
print("\nEncrypted Data (Ciphertext in Base64):", encrypted_data1)
print("\nEncrypted Data (Ciphertext in Base64):", encrypted_data2)

"""**เข้ารหัส คำใบ้ 1-2 สำหรับตรวจสอบคำใบ้**


---

- plaintext : "Correct"
- key 1 : 580100033571001864565327
- key 2 : 535987
- Ciphertext 1 : "GJtzUwnlC1Olxgc2wMtYNw=="
- Ciphertext 2 : "X/2rO+V8etpXLWcuxhDWPA=="
"""

from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
import base64

# แก้ไข Key
key_decimal1 = 580100033571001864565327
key_decimal2 = 535987

# แปลงเป็น 16 bytes
key1 = key_decimal1.to_bytes(16, byteorder='big')
key2 = key_decimal2.to_bytes(16, byteorder='big')

# Plaintext ที่จะเข้ารหัส
plaintext = "Correct".encode('utf-8')

# ใช้ AES.MODE_ECB
cipher1 = AES.new(key1, AES.MODE_ECB)
cipher2 = AES.new(key2, AES.MODE_ECB)
ciphertext1 = cipher1.encrypt(pad(plaintext, AES.block_size))
ciphertext2 = cipher2.encrypt(pad(plaintext, AES.block_size))

# บันทึก Ciphertext (base64)
encrypted_data1 = base64.b64encode(ciphertext1).decode('utf-8')
encrypted_data2 = base64.b64encode(ciphertext2).decode('utf-8')

# คำใบ้
print("คำใบ้: Key เป็นเลขฐานสิบ 16 bytes (128 บิต)")
print("Ciphertext (key 1):", encrypted_data1)
print("Ciphertext (key 2):", encrypted_data2)